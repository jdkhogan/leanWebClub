<!DOCTYPE html>
<html>
<head>
	<title>Form Autosave</title>
    <style type="text/css">
        body {
            margin: 1em auto;
            max-width: 40em;
            width: 88%;
        }

        label, input, textarea {
            display: block;
            width: 100%;
        }

        input, textarea {
            margin-bottom: 1em;
        }

        textarea {
            height: 8em;
        }
    </style>
</head>

<body>
	<h1>Form Autosave</h1>
    <form id="save-me">

        <label for="name">Name</label>
        <input type="text" name="name" id="name">

        <label for="address">Address</label>
        <input type="text" id="address">

        <label for="email">Email</label>
        <input type="email" id="email">

        <label for="more">Additional thoughts?</label>
        <textarea name="more" id="more"></textarea>

        <button type="submit">Submit</button>

    </form>
</body>

<script>
    const form = document.getElementById('save-me');
    const fields = form.elements;
    
    function loadSaved() {
        for (let field of fields) {
            let saved = localStorage.getItem(field.id);
            if (!saved) continue; // exit loop if there is no saved value for this field
            
            document.getElementById(field.id).value = saved;
        }
    }
    
    function inputHandler(e) {
        let field = e.target;

        // only save the field if it has an id
        if (!field.id) return;
        
        // remove field from storage rather than saving an empty string
        if (!field.value) {
            localStorage.removeItem(field.id);
            return;
        }

        localStorage.setItem(field.id, field.value);
    }
    
    function clickHandler() {
        fields.map(field => localStorage.removeItem(field.id));
    }

    loadSaved();
    form.addEventListener('input', inputHandler);
    form.addEventListener('submit', clickHandler);

</script>
</html>